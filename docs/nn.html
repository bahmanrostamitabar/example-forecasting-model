<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Neural Net | Model Estimation by Example</title>
  <meta name="description" content="This document provides ‘by-hand’ demonstrations of various models and algorithms. The goal is to take away some of the mystery by providing clean code examples that are easy to run and compare with other tools." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Neural Net | Model Estimation by Example" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://m-clark.github.io/models-by-example/" />
  <meta property="og:image" content="https://m-clark.github.io/models-by-example/img/nineteeneightyR.png" />
  <meta property="og:description" content="This document provides ‘by-hand’ demonstrations of various models and algorithms. The goal is to take away some of the mystery by providing clean code examples that are easy to run and compare with other tools." />
  <meta name="github-repo" content="m-clark/models-by-example/" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Neural Net | Model Estimation by Example" />
  
  <meta name="twitter:description" content="This document provides ‘by-hand’ demonstrations of various models and algorithms. The goal is to take away some of the mystery by providing clean code examples that are easy to run and compare with other tools." />
  <meta name="twitter:image" content="https://m-clark.github.io/models-by-example/img/nineteeneightyR.png" />




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="img/R.ico" type="image/x-icon" />
<link rel="prev" href="gaussian-process.html"/>
<link rel="next" href="elm.html"/>
<script src="libs/header-attrs-2.5/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.5.2/htmlwidgets.js"></script>
<script src="libs/viz-1.8.2/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.6.1/grViz.js"></script>
<script src="libs/plotly-binding-4.9.2.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.52.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.52.2/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css/book.css" type="text/css" />
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.14.0/css/all.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class='before'><a href="./">Model Estimation by Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="part"><span><b>Models</b></span></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i>Linear Regression</a>
<ul>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#data-setup"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#functions"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#estimation"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#comparison"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#source"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html"><i class="fa fa-check"></i>Logistic Regression</a>
<ul>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html#data-setup-1"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html#functions-1"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html#estimation-1"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html#comparison-1"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html#source-1"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="mixed-model-one-factor.html"><a href="mixed-model-one-factor.html"><i class="fa fa-check"></i>One-factor Mixed Model</a>
<ul>
<li class="chapter" data-level="" data-path="mixed-model-one-factor.html"><a href="mixed-model-one-factor.html#data-setup-2"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="mixed-model-one-factor.html"><a href="mixed-model-one-factor.html#function"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="mixed-model-one-factor.html"><a href="mixed-model-one-factor.html#estimation-2"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="mixed-model-one-factor.html"><a href="mixed-model-one-factor.html#comparison-2"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="mixed-model-one-factor.html"><a href="mixed-model-one-factor.html#source-2"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="mixed-model-two-factor.html"><a href="mixed-model-two-factor.html"><i class="fa fa-check"></i>Two-factor Mixed Model</a>
<ul>
<li class="chapter" data-level="" data-path="mixed-model-two-factor.html"><a href="mixed-model-two-factor.html#data-setup-3"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="mixed-model-two-factor.html"><a href="mixed-model-two-factor.html#function-1"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="mixed-model-two-factor.html"><a href="mixed-model-two-factor.html#estimation-3"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="mixed-model-two-factor.html"><a href="mixed-model-two-factor.html#comparison-3"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="mixed-model-two-factor.html"><a href="mixed-model-two-factor.html#source-3"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="mixed-model-ML.html"><a href="mixed-model-ML.html"><i class="fa fa-check"></i>Mixed Model via ML</a>
<ul>
<li class="chapter" data-level="" data-path="mixed-model-ML.html"><a href="mixed-model-ML.html#introduction-1"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="mixed-model-ML.html"><a href="mixed-model-ML.html#maximum-likelihood-estimation"><i class="fa fa-check"></i>Maximum Likelihood Estimation</a>
<ul>
<li class="chapter" data-level="" data-path="mixed-model-ML.html"><a href="mixed-model-ML.html#data-setup-4"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="mixed-model-ML.html"><a href="mixed-model-ML.html#function-2"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="mixed-model-ML.html"><a href="mixed-model-ML.html#estimation-4"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="mixed-model-ML.html"><a href="mixed-model-ML.html#issues-with-ml-estimation"><i class="fa fa-check"></i>Issues with ML estimation</a></li>
<li class="chapter" data-level="" data-path="mixed-model-ML.html"><a href="mixed-model-ML.html#link-with-penalized-regression"><i class="fa fa-check"></i>Link with penalized regression</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="mixed-model-ML.html"><a href="mixed-model-ML.html#source-4"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="probit.html"><a href="probit.html"><i class="fa fa-check"></i>Probit &amp; Bivariate Probit</a>
<ul>
<li class="chapter" data-level="" data-path="probit.html"><a href="probit.html#standard-probit"><i class="fa fa-check"></i>Standard Probit</a>
<ul>
<li class="chapter" data-level="" data-path="probit.html"><a href="probit.html#function-3"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="probit.html"><a href="probit.html#examples"><i class="fa fa-check"></i>Examples</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="probit.html"><a href="probit.html#bivariate-probit"><i class="fa fa-check"></i>Bivariate Probit</a>
<ul>
<li class="chapter" data-level="" data-path="probit.html"><a href="probit.html#example"><i class="fa fa-check"></i>Example</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="probit.html"><a href="probit.html#source-5"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html"><i class="fa fa-check"></i>Heckman Selection</a>
<ul>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html#data-setup-5"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html#two-step-approach"><i class="fa fa-check"></i>Two step approach</a>
<ul>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html#step-1-probit-model"><i class="fa fa-check"></i>Step 1: Probit Model</a></li>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html#step-2-estimate-via-linear-regression"><i class="fa fa-check"></i>Step 2: Estimate via Linear Regression</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html#maximum-likelihood"><i class="fa fa-check"></i>Maximum Likelihood</a>
<ul>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html#comparison-4"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html#source-6"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="marginal-structural.html"><a href="marginal-structural.html"><i class="fa fa-check"></i>Marginal Structural Model</a>
<ul>
<li class="chapter" data-level="" data-path="marginal-structural.html"><a href="marginal-structural.html#data-setup-6"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="marginal-structural.html"><a href="marginal-structural.html#function-4"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="marginal-structural.html"><a href="marginal-structural.html#estimation-5"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="marginal-structural.html"><a href="marginal-structural.html#comparison-5"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="marginal-structural.html"><a href="marginal-structural.html#source-7"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html"><i class="fa fa-check"></i>Tobit</a>
<ul>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#censoring-with-an-upper-limit"><i class="fa fa-check"></i>Censoring with an Upper Limit</a>
<ul>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#data-setup-7"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#function-5"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#estimation-6"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#comparison-6"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#censoring-with-a-lower-limit"><i class="fa fa-check"></i>Censoring with a Lower Limit</a>
<ul>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#comparison-7"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#source-8"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html"><i class="fa fa-check"></i>Cox Survival</a>
<ul>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#standard-proportional-hazards"><i class="fa fa-check"></i>Standard Proportional Hazards</a>
<ul>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#data-setup-8"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#function-6"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#estimation-7"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#comparison-8"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#time-varying-coefficients"><i class="fa fa-check"></i>Time-varying coefficients</a>
<ul>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#data-setup-9"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#function-7"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#estimation-8"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#comparison-9"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#stratified-cox-model"><i class="fa fa-check"></i>Stratified Cox Model</a>
<ul>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#data-setup-10"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#function-8"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#estimation-9"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#comparison-10"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#source-9"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html"><i class="fa fa-check"></i>Hurdle Model</a>
<ul>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#poisson"><i class="fa fa-check"></i>Poisson</a>
<ul>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#data-setup-11"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#function-9"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#estimation-10"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#comparison-11"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#negative-binomial"><i class="fa fa-check"></i>Negative Binomial</a>
<ul>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#function-10"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#estimation-11"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#comparison-12"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#source-10"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html"><i class="fa fa-check"></i>Zero-Inflated Model</a>
<ul>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#poisson-1"><i class="fa fa-check"></i>Poisson</a>
<ul>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#data-setup-12"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#function-11"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#estimation-12"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#comparison-13"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#negative-binomial-1"><i class="fa fa-check"></i>Negative Binomial</a>
<ul>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#function-12"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#estimation-13"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#comparison-14"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#supplemental-example"><i class="fa fa-check"></i>Supplemental Example</a></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#source-11"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="naive-bayes.html"><a href="naive-bayes.html"><i class="fa fa-check"></i>Naive Bayes</a>
<ul>
<li class="chapter" data-level="" data-path="naive-bayes.html"><a href="naive-bayes.html#initialization"><i class="fa fa-check"></i>Initialization</a></li>
<li class="chapter" data-level="" data-path="naive-bayes.html"><a href="naive-bayes.html#comparison-15"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="naive-bayes.html"><a href="naive-bayes.html#source-12"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html"><i class="fa fa-check"></i>Multinomial</a>
<ul>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#standard-categorical-model"><i class="fa fa-check"></i>Standard (Categorical) Model</a>
<ul>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#data-setup-13"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#function-13"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#comparison-16"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#alternative-specific-and-constant-variables"><i class="fa fa-check"></i>Alternative specific and constant variables</a>
<ul>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#comparison-17"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#source-13"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ordinal.html"><a href="ordinal.html"><i class="fa fa-check"></i>Ordinal</a>
<ul>
<li class="chapter" data-level="" data-path="ordinal.html"><a href="ordinal.html#data"><i class="fa fa-check"></i>Data</a></li>
<li class="chapter" data-level="" data-path="ordinal.html"><a href="ordinal.html#function-14"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="ordinal.html"><a href="ordinal.html#estimation-14"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="ordinal.html"><a href="ordinal.html#comparison-18"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="ordinal.html"><a href="ordinal.html#source-14"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html"><i class="fa fa-check"></i>Markov Model</a>
<ul>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#data-setup-14"><i class="fa fa-check"></i>Data Setup</a>
<ul>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#data-functions"><i class="fa fa-check"></i>Data Functions</a></li>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#two-states-demo"><i class="fa fa-check"></i>Two states Demo</a></li>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#three-states-demo"><i class="fa fa-check"></i>Three states demo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#function-15"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#estimation-15"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#comparison-19"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#source-15"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="hmm.html"><a href="hmm.html"><i class="fa fa-check"></i>Hidden Markov Model</a>
<ul>
<li class="chapter" data-level="" data-path="hmm.html"><a href="hmm.html#data-setup-15"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="hmm.html"><a href="hmm.html#function-16"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="hmm.html"><a href="hmm.html#estimation-16"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="hmm.html"><a href="hmm.html#supplemental-demo"><i class="fa fa-check"></i>Supplemental demo</a></li>
<li class="chapter" data-level="" data-path="hmm.html"><a href="hmm.html#source-16"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html"><i class="fa fa-check"></i>Quantile Regression</a>
<ul>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html#data-setup-16"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html#function-17"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html#estimation-17"><i class="fa fa-check"></i>Estimation</a>
<ul>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html#other-quantiles"><i class="fa fa-check"></i>Other quantiles</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html#comparison-20"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html#visualize"><i class="fa fa-check"></i>Visualize</a></li>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html#source-17"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cubic-spline.html"><a href="cubic-spline.html"><i class="fa fa-check"></i>Cubic Spline Model</a>
<ul>
<li class="chapter" data-level="" data-path="cubic-spline.html"><a href="cubic-spline.html#data-setup-17"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="cubic-spline.html"><a href="cubic-spline.html#functions-2"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="cubic-spline.html"><a href="cubic-spline.html#example-1"><i class="fa fa-check"></i>Example 1</a></li>
<li class="chapter" data-level="" data-path="cubic-spline.html"><a href="cubic-spline.html#example-2"><i class="fa fa-check"></i>Example 2</a></li>
<li class="chapter" data-level="" data-path="cubic-spline.html"><a href="cubic-spline.html#source-18"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html"><i class="fa fa-check"></i>Gausian Processes</a>
<ul>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#noise-free-demonstration"><i class="fa fa-check"></i>Noise-Free Demonstration</a>
<ul>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#data-setup-18"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#functions-3"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#visualize-the-prior-distribution"><i class="fa fa-check"></i>Visualize the prior distribution</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#generate-the-posterior-predictive-distribution"><i class="fa fa-check"></i>Generate the posterior predictive distribution</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#visualize-the-posterior-predictive-distribution"><i class="fa fa-check"></i>Visualize the Posterior Predictive Distribution</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#noisy-demonstration"><i class="fa fa-check"></i>Noisy Demonstration</a>
<ul>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#data-setup-19"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#functions-4"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#visualize-the-prior-distribution-1"><i class="fa fa-check"></i>Visualize the prior distribution</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#generate-the-posterior-predictive-distribution-1"><i class="fa fa-check"></i>Generate the posterior predictive distribution</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#visualize-the-posterior-predictive-distribution-1"><i class="fa fa-check"></i>Visualize the Posterior Predictive Distribution</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#source-19"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="nn.html"><a href="nn.html"><i class="fa fa-check"></i>Neural Net</a>
<ul>
<li class="chapter" data-level="" data-path="nn.html"><a href="nn.html#example-1-1"><i class="fa fa-check"></i>Example 1</a>
<ul>
<li class="chapter" data-level="" data-path="nn.html"><a href="nn.html#python"><i class="fa fa-check"></i>Python</a></li>
<li class="chapter" data-level="" data-path="nn.html"><a href="nn.html#r"><i class="fa fa-check"></i>R</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="nn.html"><a href="nn.html#example-2-1"><i class="fa fa-check"></i>Example 2</a>
<ul>
<li class="chapter" data-level="" data-path="nn.html"><a href="nn.html#python-1"><i class="fa fa-check"></i>Python</a></li>
<li class="chapter" data-level="" data-path="nn.html"><a href="nn.html#r-1"><i class="fa fa-check"></i>R</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="nn.html"><a href="nn.html#example-3"><i class="fa fa-check"></i>Example 3</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="elm.html"><a href="elm.html"><i class="fa fa-check"></i>Extreme Learning Machine</a>
<ul>
<li class="chapter" data-level="" data-path="elm.html"><a href="elm.html#data-setup-20"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="elm.html"><a href="elm.html#function-18"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="elm.html"><a href="elm.html#estimation-18"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="elm.html"><a href="elm.html#comparison-21"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="elm.html"><a href="elm.html#supplemental-example-1"><i class="fa fa-check"></i>Supplemental Example</a></li>
<li class="chapter" data-level="" data-path="elm.html"><a href="elm.html#source-20"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html"><i class="fa fa-check"></i>Reproducing Kernel Hilbert Space Regression</a>
<ul>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#data-setup-21"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#functions-5"><i class="fa fa-check"></i>Functions</a>
<ul>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#function-to-find-the-inverse-of-a-matrix"><i class="fa fa-check"></i>Function to find the inverse of a matrix</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#reproducing-kernel"><i class="fa fa-check"></i>Reproducing Kernel</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#gram-matrix"><i class="fa fa-check"></i>Gram matrix</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#ridge-regression"><i class="fa fa-check"></i>Ridge regression</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#estimation-19"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#comparison-22"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#example-cubic-spline"><i class="fa fa-check"></i>Example: Cubic Spline</a>
<ul>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#data-setup-22"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#functions-6"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#estimation-20"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#comparison-23"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#source-21"><i class="fa fa-check"></i>Source</a>
<ul>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#current-supplemental-code"><i class="fa fa-check"></i>Current Supplemental Code</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#original-supplemental-code"><i class="fa fa-check"></i>Original Supplemental Code</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html"><i class="fa fa-check"></i>Confirmatory Factor Analysis</a>
<ul>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#data-setup-23"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#functions-7"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#estimation-21"><i class="fa fa-check"></i>Estimation</a>
<ul>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#raw"><i class="fa fa-check"></i>Raw</a></li>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#standardized"><i class="fa fa-check"></i>Standardized</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#comparison-24"><i class="fa fa-check"></i>Comparison</a>
<ul>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#mplus"><i class="fa fa-check"></i>Mplus</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#source-22"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="part"><span><b>Bayesian</b></span></li>
<li class="chapter" data-level="" data-path="bayesian.html"><a href="bayesian.html"><i class="fa fa-check"></i>Introduction to Bayesian Methods</a></li>
<li class="chapter" data-level="" data-path="bayesian-basics.html"><a href="bayesian-basics.html"><i class="fa fa-check"></i>Basics</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-basics.html"><a href="bayesian-basics.html#prior-likelihood-posterior-distributions"><i class="fa fa-check"></i>Prior, likelihood, &amp; posterior distributions</a></li>
<li class="chapter" data-level="" data-path="bayesian-basics.html"><a href="bayesian-basics.html#prior"><i class="fa fa-check"></i>Prior</a></li>
<li class="chapter" data-level="" data-path="bayesian-basics.html"><a href="bayesian-basics.html#likelihood"><i class="fa fa-check"></i>Likelihood</a></li>
<li class="chapter" data-level="" data-path="bayesian-basics.html"><a href="bayesian-basics.html#posterior"><i class="fa fa-check"></i>Posterior</a></li>
<li class="chapter" data-level="" data-path="bayesian-basics.html"><a href="bayesian-basics.html#posterior-predictive"><i class="fa fa-check"></i>Posterior predictive</a></li>
<li class="chapter" data-level="" data-path="bayesian-basics.html"><a href="bayesian-basics.html#source-23"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-t-test.html"><a href="bayesian-t-test.html"><i class="fa fa-check"></i>Bayesian t-test</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-t-test.html"><a href="bayesian-t-test.html#data-setup-24"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-t-test.html"><a href="bayesian-t-test.html#model-code"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian-t-test.html"><a href="bayesian-t-test.html#estimation-22"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-t-test.html"><a href="bayesian-t-test.html#comparison-25"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="bayesian-t-test.html"><a href="bayesian-t-test.html#visualization"><i class="fa fa-check"></i>Visualization</a></li>
<li class="chapter" data-level="" data-path="bayesian-t-test.html"><a href="bayesian-t-test.html#source-24"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-linear-regression.html"><a href="bayesian-linear-regression.html"><i class="fa fa-check"></i>Bayesian Linear Regression</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-linear-regression.html"><a href="bayesian-linear-regression.html#data-setup-25"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-linear-regression.html"><a href="bayesian-linear-regression.html#model-code-1"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian-linear-regression.html"><a href="bayesian-linear-regression.html#estimation-23"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-linear-regression.html"><a href="bayesian-linear-regression.html#comparison-26"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="bayesian-linear-regression.html"><a href="bayesian-linear-regression.html#visualize-1"><i class="fa fa-check"></i>Visualize</a></li>
<li class="chapter" data-level="" data-path="bayesian-linear-regression.html"><a href="bayesian-linear-regression.html#source-25"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-beta-regression.html"><a href="bayesian-beta-regression.html"><i class="fa fa-check"></i>Bayesian Beta Regression</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-beta-regression.html"><a href="bayesian-beta-regression.html#data-setup-26"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-beta-regression.html"><a href="bayesian-beta-regression.html#model-code-2"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian-beta-regression.html"><a href="bayesian-beta-regression.html#estimation-24"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-beta-regression.html"><a href="bayesian-beta-regression.html#comparison-27"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="bayesian-beta-regression.html"><a href="bayesian-beta-regression.html#visualization-1"><i class="fa fa-check"></i>Visualization</a></li>
<li class="chapter" data-level="" data-path="bayesian-beta-regression.html"><a href="bayesian-beta-regression.html#source-26"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-model.html"><a href="bayesian-mixed-model.html"><i class="fa fa-check"></i>Bayesian Mixed Model</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-mixed-model.html"><a href="bayesian-mixed-model.html#data-setup-27"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-model.html"><a href="bayesian-mixed-model.html#model-code-3"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-model.html"><a href="bayesian-mixed-model.html#estimation-25"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-model.html"><a href="bayesian-mixed-model.html#comparison-28"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-model.html"><a href="bayesian-mixed-model.html#visualize-2"><i class="fa fa-check"></i>Visualize</a></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-model.html"><a href="bayesian-mixed-model.html#source-27"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-mediation.html"><a href="bayesian-mixed-mediation.html"><i class="fa fa-check"></i>Bayesian Multilevel Mediation</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-mixed-mediation.html"><a href="bayesian-mixed-mediation.html#data-setup-28"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-mediation.html"><a href="bayesian-mixed-mediation.html#model-code-4"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-mediation.html"><a href="bayesian-mixed-mediation.html#estimation-26"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-mediation.html"><a href="bayesian-mixed-mediation.html#comparison-29"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-mediation.html"><a href="bayesian-mixed-mediation.html#visualization-2"><i class="fa fa-check"></i>Visualization</a></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-mediation.html"><a href="bayesian-mixed-mediation.html#source-28"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html"><i class="fa fa-check"></i>Bayesian IRT</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#one-parameter-irt"><i class="fa fa-check"></i>One Parameter IRT</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#data-setup-29"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#model-code-5"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#estimation-27"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#comparison-30"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#two-parameter-irt"><i class="fa fa-check"></i>Two Parameter IRT</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#model-code-6"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#estimation-28"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#comparison-31"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#three-parameter-irt"><i class="fa fa-check"></i>Three Parameter IRT</a></li>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#four-parameter-irt"><i class="fa fa-check"></i>Four Parameter IRT</a></li>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#source-29"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-cfa.html"><a href="bayesian-cfa.html"><i class="fa fa-check"></i>Bayesian CFA</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-cfa.html"><a href="bayesian-cfa.html#data-setup-30"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-cfa.html"><a href="bayesian-cfa.html#model-code-7"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian-cfa.html"><a href="bayesian-cfa.html#estimation-29"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-cfa.html"><a href="bayesian-cfa.html#comparison-32"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="bayesian-cfa.html"><a href="bayesian-cfa.html#source-30"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-non-parametric.html"><a href="bayesian-non-parametric.html"><i class="fa fa-check"></i>Bayesian Nonparametric Models</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-non-parametric.html"><a href="bayesian-non-parametric.html#chinese-restaurant-process"><i class="fa fa-check"></i>Chinese Restaurant Process</a></li>
<li class="chapter" data-level="" data-path="bayesian-non-parametric.html"><a href="bayesian-non-parametric.html#indian-buffet-process"><i class="fa fa-check"></i>Indian Buffet Process</a></li>
<li class="chapter" data-level="" data-path="bayesian-non-parametric.html"><a href="bayesian-non-parametric.html#source-31"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-stochastic-volatility.html"><a href="bayesian-stochastic-volatility.html"><i class="fa fa-check"></i>Bayesian Stochastic Volatility Model</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-stochastic-volatility.html"><a href="bayesian-stochastic-volatility.html#data-setup-31"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-stochastic-volatility.html"><a href="bayesian-stochastic-volatility.html#model-code-8"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian-stochastic-volatility.html"><a href="bayesian-stochastic-volatility.html#estimation-30"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-stochastic-volatility.html"><a href="bayesian-stochastic-volatility.html#results"><i class="fa fa-check"></i>Results</a></li>
<li class="chapter" data-level="" data-path="bayesian-stochastic-volatility.html"><a href="bayesian-stochastic-volatility.html#visualization-3"><i class="fa fa-check"></i>Visualization</a></li>
<li class="chapter" data-level="" data-path="bayesian-stochastic-volatility.html"><a href="bayesian-stochastic-volatility.html#source-32"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-multinomial-model.html"><a href="bayesian-multinomial-model.html"><i class="fa fa-check"></i>Bayesian Multinomial Models</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-multinomial-model.html"><a href="bayesian-multinomial-model.html#data-setup-32"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-multinomial-model.html"><a href="bayesian-multinomial-model.html#model-code-9"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian-multinomial-model.html"><a href="bayesian-multinomial-model.html#estimation-31"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-multinomial-model.html"><a href="bayesian-multinomial-model.html#comparison-33"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="bayesian-multinomial-model.html"><a href="bayesian-multinomial-model.html#adding-complexity"><i class="fa fa-check"></i>Adding Complexity</a></li>
<li class="chapter" data-level="" data-path="bayesian-multinomial-model.html"><a href="bayesian-multinomial-model.html#source-33"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-variational.html"><a href="bayesian-variational.html"><i class="fa fa-check"></i>Variational Bayes Regression</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-variational.html"><a href="bayesian-variational.html#data-setup-33"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-variational.html"><a href="bayesian-variational.html#function-19"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="bayesian-variational.html"><a href="bayesian-variational.html#estimation-32"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-variational.html"><a href="bayesian-variational.html#comparison-34"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="bayesian-variational.html"><a href="bayesian-variational.html#visualization-4"><i class="fa fa-check"></i>Visualization</a></li>
<li class="chapter" data-level="" data-path="bayesian-variational.html"><a href="bayesian-variational.html#supplemental-example-2"><i class="fa fa-check"></i>Supplemental Example</a></li>
<li class="chapter" data-level="" data-path="bayesian-variational.html"><a href="bayesian-variational.html#source-34"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-topic-model.html"><a href="bayesian-topic-model.html"><i class="fa fa-check"></i>Topic Model</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-topic-model.html"><a href="bayesian-topic-model.html#data-setup-34"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-topic-model.html"><a href="bayesian-topic-model.html#function-20"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="bayesian-topic-model.html"><a href="bayesian-topic-model.html#estimation-33"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-topic-model.html"><a href="bayesian-topic-model.html#comparison-35"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="bayesian-topic-model.html"><a href="bayesian-topic-model.html#source-35"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="part"><span><b>Estimation</b></span></li>
<li class="chapter" data-level="" data-path="maximum-likelihood.html"><a href="maximum-likelihood.html"><i class="fa fa-check"></i>Maximum Likelihood</a>
<ul>
<li class="chapter" data-level="" data-path="maximum-likelihood.html"><a href="maximum-likelihood.html#example-4"><i class="fa fa-check"></i>Example</a></li>
<li class="chapter" data-level="" data-path="maximum-likelihood.html"><a href="maximum-likelihood.html#linear-model"><i class="fa fa-check"></i>Linear Model</a></li>
<li class="chapter" data-level="" data-path="maximum-likelihood.html"><a href="maximum-likelihood.html#source-36"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html"><i class="fa fa-check"></i>Penalized Maximum Likelihood</a>
<ul>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#data-setup-35"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#functions-8"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#estimation-34"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#comparison-36"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#source-37"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="lasso.html"><a href="lasso.html"><i class="fa fa-check"></i>L1 (lasso) regularization</a>
<ul>
<li class="chapter" data-level="" data-path="lasso.html"><a href="lasso.html#data-setup-36"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="lasso.html"><a href="lasso.html#functions-9"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="lasso.html"><a href="lasso.html#estimation-35"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="lasso.html"><a href="lasso.html#comparison-37"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="lasso.html"><a href="lasso.html#source-38"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ridge.html"><a href="ridge.html"><i class="fa fa-check"></i>L2 (ridge) regularization</a>
<ul>
<li class="chapter" data-level="" data-path="ridge.html"><a href="ridge.html#data-setup-37"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="ridge.html"><a href="ridge.html#function-21"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="ridge.html"><a href="ridge.html#estimation-36"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="ridge.html"><a href="ridge.html#comparison-38"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="ridge.html"><a href="ridge.html#source-39"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html"><i class="fa fa-check"></i>Newton and IRLS</a>
<ul>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html#data-setup-38"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html#functions-10"><i class="fa fa-check"></i>Functions</a>
<ul>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html#newtons-method"><i class="fa fa-check"></i>Newton’s Method</a></li>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html#irls"><i class="fa fa-check"></i>IRLS</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html#estimation-37"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html#comparison-39"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html#source-40"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html"><i class="fa fa-check"></i>Nelder Mead</a>
<ul>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#functions-11"><i class="fa fa-check"></i>Functions</a>
<ul>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#first-version"><i class="fa fa-check"></i>First Version</a></li>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#example-5"><i class="fa fa-check"></i>Example</a></li>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#a-regression-model"><i class="fa fa-check"></i>A Regression Model</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#second-version"><i class="fa fa-check"></i>Second Version</a>
<ul>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#example-6"><i class="fa fa-check"></i>Example</a></li>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#a-regression-model-1"><i class="fa fa-check"></i>A Regression Model</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#source-41"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html"><i class="fa fa-check"></i>Expectation-Maximization</a>
<ul>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#mixture-model"><i class="fa fa-check"></i>Mixture Model</a>
<ul>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#data-setup-40"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#function-22"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#estimation-38"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#comparison-42"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#visualization-5"><i class="fa fa-check"></i>Visualization</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#supplemental-example-3"><i class="fa fa-check"></i>Supplemental Example</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#source-42"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#multivariate-mixture-model"><i class="fa fa-check"></i>Multivariate Mixture Model</a>
<ul>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#function-23"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#example-1-old-faithful"><i class="fa fa-check"></i>Example 1: Old Faithful</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#example-2-iris"><i class="fa fa-check"></i>Example 2: Iris</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#source-43"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#probit-model"><i class="fa fa-check"></i>Probit Model</a>
<ul>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#data-setup-43"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#probit-via-maximum-likelihood"><i class="fa fa-check"></i>Probit via Maximum Likelihood</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#em-for-latent-variable-approach-to-probit"><i class="fa fa-check"></i>EM for Latent Variable Approach to Probit</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#source-44"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#pca"><i class="fa fa-check"></i>PCA</a>
<ul>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#data-setup-44"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#function-26"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#estimation-43"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#comparison-47"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#visualize-4"><i class="fa fa-check"></i>Visualize</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#source-45"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#probabilistic-pca"><i class="fa fa-check"></i>Probabilistic PCA</a>
<ul>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#data-setup-45"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#function-27"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#estimation-44"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#comparison-48"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#visualize-5"><i class="fa fa-check"></i>Visualize</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#missing-data-example"><i class="fa fa-check"></i>Missing Data Example</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#source-46"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#state-space-model"><i class="fa fa-check"></i>State Space Model</a>
<ul>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#data-setup-47"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#function-29"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#estimation-46"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#visualization-6"><i class="fa fa-check"></i>Visualization</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#source-47"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="gradient-descent.html"><a href="gradient-descent.html"><i class="fa fa-check"></i>Gradient Descent</a>
<ul>
<li class="chapter" data-level="" data-path="gradient-descent.html"><a href="gradient-descent.html#data-setup-48"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="gradient-descent.html"><a href="gradient-descent.html#function-30"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="gradient-descent.html"><a href="gradient-descent.html#estimation-47"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="gradient-descent.html"><a href="gradient-descent.html#comparison-50"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="gradient-descent.html"><a href="gradient-descent.html#source-48"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html"><i class="fa fa-check"></i>Stochastic Gradient Descent</a>
<ul>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#data-setup-49"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#function-31"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#estimation-48"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#comparison-51"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#visualize-estimates"><i class="fa fa-check"></i>Visualize Estimates</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#data-set-shift"><i class="fa fa-check"></i>Data Set Shift</a>
<ul>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#estimation-49"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#comparison-52"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#visualize-estimates-1"><i class="fa fa-check"></i>Visualize Estimates</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#source-49"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="metropolis-hastings.html"><a href="metropolis-hastings.html"><i class="fa fa-check"></i>Metropolis Hastings</a>
<ul>
<li class="chapter" data-level="" data-path="metropolis-hastings.html"><a href="metropolis-hastings.html#data-setup-50"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="metropolis-hastings.html"><a href="metropolis-hastings.html#functions-12"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="metropolis-hastings.html"><a href="metropolis-hastings.html#estimation-50"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="metropolis-hastings.html"><a href="metropolis-hastings.html#comparison-53"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="metropolis-hastings.html"><a href="metropolis-hastings.html#source-50"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="hamiltonian-monte-carlo.html"><a href="hamiltonian-monte-carlo.html"><i class="fa fa-check"></i>Hamiltonian Monte Carlo</a>
<ul>
<li class="chapter" data-level="" data-path="hamiltonian-monte-carlo.html"><a href="hamiltonian-monte-carlo.html#data-setup-51"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="hamiltonian-monte-carlo.html"><a href="hamiltonian-monte-carlo.html#functions-13"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="hamiltonian-monte-carlo.html"><a href="hamiltonian-monte-carlo.html#estimation-51"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="hamiltonian-monte-carlo.html"><a href="hamiltonian-monte-carlo.html#comparison-54"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="hamiltonian-monte-carlo.html"><a href="hamiltonian-monte-carlo.html#source-51"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="part"><span><b>Other</b></span></li>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html"><i class="fa fa-check"></i>Supplemental</a>
<ul>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html#other-languages"><i class="fa fa-check"></i>Other Languages</a>
<ul>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html#python-demos"><i class="fa fa-check"></i>Python Demos</a></li>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html#julia-demos"><i class="fa fa-check"></i>Julia Demos</a></li>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html#matlab-demos"><i class="fa fa-check"></i>Matlab Demos</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li class='after'">
   <a href="https://m-clark.github.io/">
      <img src="img/mc_logo.png" style="width:25%; padding:0px 0; display:block; margin: 0 auto;" alt="MC logo">
   </a>
</li>
<li class='after'">
   <div style='text-align:center'>
      <a href="https://github.com/m-clark/">
         <i class="fab fa-github fa-2x" aria-hidden="true"></i>
      </a>
   </div>
</li>
<li class='after'">
   <div style='text-align:center'>
      <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">
         <i class="fab fa-creative-commons fa-lg"></i>
         <i class="fab fa-creative-commons-by fa-lg"></i>
         <i class="fab fa-creative-commons-sa fa-lg"></i>
      </a>
   </div>
</li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Model Estimation by Example</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="neural-net" class="section level1">
<h1>Neural Net</h1>
<p>The following example follows comes from <a href="https://iamtrask.github.io/2015/07/12/basic-python-network/">Andrew Trask’s old blog ost</a>, which is nice because it tries to demonstrate a neural net via backpropagation in very few lines, much like this document does elsewhere.</p>
<ul>
<li><a href="https://iamtrask.github.io/2015/07/12/basic-python-network/" class="uri">https://iamtrask.github.io/2015/07/12/basic-python-network/</a></li>
<li><a href="https://iamtrask.github.io/2015/07/27/python-network-part2/" class="uri">https://iamtrask.github.io/2015/07/27/python-network-part2/</a></li>
</ul>
<p>The data setup is very simple, and I keep the Python code almost identical outside of very slight cosmetic (mostly name/space) changes. For more detail I suggest following the posts, but I’ll add some here and there.</p>
<div id="example-1-1" class="section level2">
<h2>Example 1</h2>
<div id="python" class="section level3">
<h3>Python</h3>
<p>From the blog:</p>
<blockquote>
<ul>
<li><strong>X</strong> Input dataset matrix where each row is a training example</li>
<li><strong>y</strong> Output dataset matrix where each row is a training example</li>
<li><strong>layer_0</strong> First Layer of the Network, specified by the input data</li>
<li><strong>layer_1</strong> Second Layer of the Network, otherwise known as the hidden layer</li>
<li><strong>synapse_0</strong> First layer of weights, Synapse 0, connecting layer_0 to layer_1.</li>
<li><strong>*</strong> Elementwise multiplication, so two vectors of equal size are multiplying corresponding values 1-to-1 to generate a final vector of identical size.</li>
<li><strong>-</strong> Elementwise subtraction, so two vectors of equal size are subtracting corresponding values 1-to-1 to generate a final vector of identical size.</li>
<li><strong>x.dot(y)</strong> If x and y are vectors, this is a dot product. If both are matrices, it’s a matrix-matrix multiplication. If only one is a matrix, then it’s vector matrix multiplication.</li>
</ul>
</blockquote>
<p>In this initial example, while it can serve as instructive starting point for backpropagation, we’re not really using a neural net, but rather just an alternative way to estimate a logistic regression. <code>layer_1</code> in this case is just the linear predictor after transformation.</p>
<p>Note that in this particular example however, that the first column is perfectly correlated with the target <code>y</code>, which would cause a problem if no regularization were applied.</p>
<div class="sourceCode" id="cb303"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb303-1"><a href="nn.html#cb303-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb303-2"><a href="nn.html#cb303-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb303-3"><a href="nn.html#cb303-3" aria-hidden="true" tabindex="-1"></a><span class="co"># sigmoid function</span></span>
<span id="cb303-4"><a href="nn.html#cb303-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> nonlin(x, deriv <span class="op">=</span> <span class="va">False</span>):</span>
<span id="cb303-5"><a href="nn.html#cb303-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(deriv <span class="op">==</span> <span class="va">True</span>):</span>
<span id="cb303-6"><a href="nn.html#cb303-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> x<span class="op">*</span>(<span class="dv">1</span> <span class="op">-</span> x)</span>
<span id="cb303-7"><a href="nn.html#cb303-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span> <span class="op">+</span> np.exp(<span class="op">-</span>x))</span>
<span id="cb303-8"><a href="nn.html#cb303-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb303-9"><a href="nn.html#cb303-9" aria-hidden="true" tabindex="-1"></a><span class="co"># input dataset</span></span>
<span id="cb303-10"><a href="nn.html#cb303-10" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> np.array([ [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>],</span>
<span id="cb303-11"><a href="nn.html#cb303-11" aria-hidden="true" tabindex="-1"></a>               [<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>],</span>
<span id="cb303-12"><a href="nn.html#cb303-12" aria-hidden="true" tabindex="-1"></a>               [<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>],</span>
<span id="cb303-13"><a href="nn.html#cb303-13" aria-hidden="true" tabindex="-1"></a>               [<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>] ])</span>
<span id="cb303-14"><a href="nn.html#cb303-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb303-15"><a href="nn.html#cb303-15" aria-hidden="true" tabindex="-1"></a><span class="co"># output dataset            </span></span>
<span id="cb303-16"><a href="nn.html#cb303-16" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.array([[<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>]]).T</span>
<span id="cb303-17"><a href="nn.html#cb303-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb303-18"><a href="nn.html#cb303-18" aria-hidden="true" tabindex="-1"></a><span class="co"># seed random numbers to make calculation</span></span>
<span id="cb303-19"><a href="nn.html#cb303-19" aria-hidden="true" tabindex="-1"></a><span class="co"># deterministic (just a good practice)</span></span>
<span id="cb303-20"><a href="nn.html#cb303-20" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">1</span>)</span>
<span id="cb303-21"><a href="nn.html#cb303-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb303-22"><a href="nn.html#cb303-22" aria-hidden="true" tabindex="-1"></a><span class="co"># initialize weights randomly with mean 0 (or just use np.random.uniform)</span></span>
<span id="cb303-23"><a href="nn.html#cb303-23" aria-hidden="true" tabindex="-1"></a>synapse_0 <span class="op">=</span> <span class="dv">2</span><span class="op">*</span>np.random.random((<span class="dv">3</span>, <span class="dv">1</span>)) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb303-24"><a href="nn.html#cb303-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb303-25"><a href="nn.html#cb303-25" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="bu">iter</span> <span class="kw">in</span> np.arange(<span class="dv">10000</span>):</span>
<span id="cb303-26"><a href="nn.html#cb303-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb303-27"><a href="nn.html#cb303-27" aria-hidden="true" tabindex="-1"></a>    <span class="co"># forward propagation</span></span>
<span id="cb303-28"><a href="nn.html#cb303-28" aria-hidden="true" tabindex="-1"></a>    layer_0 <span class="op">=</span> X</span>
<span id="cb303-29"><a href="nn.html#cb303-29" aria-hidden="true" tabindex="-1"></a>    layer_1 <span class="op">=</span> nonlin(np.dot(layer_0, synapse_0))</span>
<span id="cb303-30"><a href="nn.html#cb303-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb303-31"><a href="nn.html#cb303-31" aria-hidden="true" tabindex="-1"></a>    <span class="co"># how much did we miss?</span></span>
<span id="cb303-32"><a href="nn.html#cb303-32" aria-hidden="true" tabindex="-1"></a>    l1_error <span class="op">=</span> y <span class="op">-</span> layer_1</span>
<span id="cb303-33"><a href="nn.html#cb303-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb303-34"><a href="nn.html#cb303-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># multiply how much we missed by the </span></span>
<span id="cb303-35"><a href="nn.html#cb303-35" aria-hidden="true" tabindex="-1"></a>    <span class="co"># slope of the sigmoid at the values in layer_1</span></span>
<span id="cb303-36"><a href="nn.html#cb303-36" aria-hidden="true" tabindex="-1"></a>    l1_delta <span class="op">=</span> l1_error <span class="op">*</span> nonlin(layer_1, <span class="va">True</span>)</span>
<span id="cb303-37"><a href="nn.html#cb303-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb303-38"><a href="nn.html#cb303-38" aria-hidden="true" tabindex="-1"></a>    <span class="co"># update weights</span></span>
<span id="cb303-39"><a href="nn.html#cb303-39" aria-hidden="true" tabindex="-1"></a>    synapse_0 <span class="op">+=</span> np.dot(layer_0.T, l1_delta)</span>
<span id="cb303-40"><a href="nn.html#cb303-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb303-41"><a href="nn.html#cb303-41" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Output After Training:&quot;</span>)</span></code></pre></div>
<pre><code>Output After Training:</code></pre>
<div class="sourceCode" id="cb305"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb305-1"><a href="nn.html#cb305-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(np.append(layer_1, y, axis <span class="op">=</span> <span class="dv">1</span>))</span></code></pre></div>
<pre><code>[[0.00966449 0.        ]
 [0.00786506 0.        ]
 [0.99358898 1.        ]
 [0.99211957 1.        ]]</code></pre>
</div>
<div id="r" class="section level3">
<h3>R</h3>
<p>For R I make a couple changes, but it should be easy to follow, and I keep the original comments.</p>
<div class="sourceCode" id="cb307"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb307-1"><a href="nn.html#cb307-1" aria-hidden="true" tabindex="-1"></a>X <span class="ot">=</span> <span class="fu">matrix</span>( </span>
<span id="cb307-2"><a href="nn.html#cb307-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, </span>
<span id="cb307-3"><a href="nn.html#cb307-3" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, </span>
<span id="cb307-4"><a href="nn.html#cb307-4" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, </span>
<span id="cb307-5"><a href="nn.html#cb307-5" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb307-6"><a href="nn.html#cb307-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">nrow  =</span> <span class="dv">4</span>,</span>
<span id="cb307-7"><a href="nn.html#cb307-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncol  =</span> <span class="dv">3</span>,</span>
<span id="cb307-8"><a href="nn.html#cb307-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">byrow =</span> <span class="cn">TRUE</span></span>
<span id="cb307-9"><a href="nn.html#cb307-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb307-10"><a href="nn.html#cb307-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb307-11"><a href="nn.html#cb307-11" aria-hidden="true" tabindex="-1"></a><span class="co"># output dataset            </span></span>
<span id="cb307-12"><a href="nn.html#cb307-12" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb307-13"><a href="nn.html#cb307-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb307-14"><a href="nn.html#cb307-14" aria-hidden="true" tabindex="-1"></a><span class="co"># seed random numbers to make calculation</span></span>
<span id="cb307-15"><a href="nn.html#cb307-15" aria-hidden="true" tabindex="-1"></a><span class="co"># deterministic (just a good practice)</span></span>
<span id="cb307-16"><a href="nn.html#cb307-16" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb307-17"><a href="nn.html#cb307-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb307-18"><a href="nn.html#cb307-18" aria-hidden="true" tabindex="-1"></a><span class="co"># initialize weights randomly with mean 0</span></span>
<span id="cb307-19"><a href="nn.html#cb307-19" aria-hidden="true" tabindex="-1"></a>synapse_0 <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">runif</span>(<span class="dv">3</span>, <span class="at">min =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">max =</span> <span class="dv">1</span>), <span class="dv">3</span>, <span class="dv">1</span>)</span>
<span id="cb307-20"><a href="nn.html#cb307-20" aria-hidden="true" tabindex="-1"></a><span class="co"># synapse_0 = py$synapse_0</span></span>
<span id="cb307-21"><a href="nn.html#cb307-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb307-22"><a href="nn.html#cb307-22" aria-hidden="true" tabindex="-1"></a><span class="co"># sigmoid function</span></span>
<span id="cb307-23"><a href="nn.html#cb307-23" aria-hidden="true" tabindex="-1"></a>nonlin <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">deriv =</span> <span class="cn">FALSE</span>) {</span>
<span id="cb307-24"><a href="nn.html#cb307-24" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (deriv)</span>
<span id="cb307-25"><a href="nn.html#cb307-25" aria-hidden="true" tabindex="-1"></a>    x <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> x)</span>
<span id="cb307-26"><a href="nn.html#cb307-26" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span></span>
<span id="cb307-27"><a href="nn.html#cb307-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plogis</span>(x)</span>
<span id="cb307-28"><a href="nn.html#cb307-28" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb307-29"><a href="nn.html#cb307-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb307-30"><a href="nn.html#cb307-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb307-31"><a href="nn.html#cb307-31" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (iter <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10000</span>) {</span>
<span id="cb307-32"><a href="nn.html#cb307-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb307-33"><a href="nn.html#cb307-33" aria-hidden="true" tabindex="-1"></a>    <span class="co"># forward propagation</span></span>
<span id="cb307-34"><a href="nn.html#cb307-34" aria-hidden="true" tabindex="-1"></a>    layer_0 <span class="ot">=</span> X</span>
<span id="cb307-35"><a href="nn.html#cb307-35" aria-hidden="true" tabindex="-1"></a>    layer_1 <span class="ot">=</span> <span class="fu">nonlin</span>(layer_0 <span class="sc">%*%</span> synapse_0)</span>
<span id="cb307-36"><a href="nn.html#cb307-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb307-37"><a href="nn.html#cb307-37" aria-hidden="true" tabindex="-1"></a>    <span class="co"># how much did we miss?</span></span>
<span id="cb307-38"><a href="nn.html#cb307-38" aria-hidden="true" tabindex="-1"></a>    l1_error <span class="ot">=</span> y <span class="sc">-</span> layer_1</span>
<span id="cb307-39"><a href="nn.html#cb307-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb307-40"><a href="nn.html#cb307-40" aria-hidden="true" tabindex="-1"></a>    <span class="co"># multiply how much we missed by the </span></span>
<span id="cb307-41"><a href="nn.html#cb307-41" aria-hidden="true" tabindex="-1"></a>    <span class="co"># slope of the sigmoid at the values in layer_1</span></span>
<span id="cb307-42"><a href="nn.html#cb307-42" aria-hidden="true" tabindex="-1"></a>    l1_delta <span class="ot">=</span> l1_error <span class="sc">*</span> <span class="fu">nonlin</span>(layer_1, <span class="at">deriv =</span> <span class="cn">TRUE</span>)</span>
<span id="cb307-43"><a href="nn.html#cb307-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb307-44"><a href="nn.html#cb307-44" aria-hidden="true" tabindex="-1"></a>    <span class="co"># update weights</span></span>
<span id="cb307-45"><a href="nn.html#cb307-45" aria-hidden="true" tabindex="-1"></a>    synapse_0 <span class="ot">=</span> synapse_0 <span class="sc">+</span> <span class="fu">crossprod</span>(layer_0, l1_delta)</span>
<span id="cb307-46"><a href="nn.html#cb307-46" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb307-47"><a href="nn.html#cb307-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb307-48"><a href="nn.html#cb307-48" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="st">&quot;Output After Training: </span><span class="sc">\n</span><span class="st">&quot;</span>, </span>
<span id="cb307-49"><a href="nn.html#cb307-49" aria-hidden="true" tabindex="-1"></a>        <span class="fu">paste0</span>(<span class="fu">capture.output</span>(<span class="fu">cbind</span>(layer_1, y)), <span class="at">collapse =</span> <span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>))</span></code></pre></div>
<p>The key idea here is the update step. Using the derivative, we are getting the slope of the sigmoid function at the point of interest. If a probability (<code>layer 1</code>) is close to zero or 1, this suggests the prediction ‘confidence’ is high, and the result is that there is less need for updating. For the others, e.g. close to <code>x = 0</code>, the predictions will be relatively more updated, as the error will be greater. The last step is to compute the weight updates for each weight for each observation, sum them, and update the weights accordingly.</p>
<pre><code>[1] 0.2689414 0.5000000 0.8807971</code></pre>
<pre><code>[1] -1  0  2</code></pre>
</div>
</div>
<div id="example-2-1" class="section level2">
<h2>Example 2</h2>
<p>In the following example, we have similarly simple data, but technically a bit harder problem to estimate. In this case, <code>y = 1</code> only if we apply the XOR function to columns 1 and 2. This makes the relationship between inputs and outputs a nonlinear one.</p>
<p>To account for the nonlinearity we will have two ‘hidden’ layers, the first of three ‘nodes’ and the last the single output node. Some might just call the last layer the output layer, as it is just the predicted probabilities. In that hidden layer, we can think of each node as a linear combination of the input, followed by a nonlinear transformation (sigmoid). The final predictions are a linear combination of the hidden layer, followed by another nonlinear transformation (sigmoid again). The last tranformation needs to put the result between 0 and 1, but you could try other transformations for the hidden layer.</p>
<div class="sourceCode" id="cb310"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb310-1"><a href="nn.html#cb310-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">=</span> <span class="st">&quot;</span></span>
<span id="cb310-2"><a href="nn.html#cb310-2" aria-hidden="true" tabindex="-1"></a><span class="st">digraph Factor  {</span></span>
<span id="cb310-3"><a href="nn.html#cb310-3" aria-hidden="true" tabindex="-1"></a><span class="st">  graph [rankdir=LR  bgcolor=transparent splines=&#39;line&#39;]</span></span>
<span id="cb310-4"><a href="nn.html#cb310-4" aria-hidden="true" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb310-5"><a href="nn.html#cb310-5" aria-hidden="true" tabindex="-1"></a><span class="st">  node [fontname=&#39;Roboto&#39; fontsize=10 fontcolor=gray50 shape=box width=.5 color=&#39;#ff5500&#39;];</span></span>
<span id="cb310-6"><a href="nn.html#cb310-6" aria-hidden="true" tabindex="-1"></a><span class="st">  node [shape=square]</span></span>
<span id="cb310-7"><a href="nn.html#cb310-7" aria-hidden="true" tabindex="-1"></a><span class="st">  X_1, X_2, X_3, y</span></span>
<span id="cb310-8"><a href="nn.html#cb310-8" aria-hidden="true" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb310-9"><a href="nn.html#cb310-9" aria-hidden="true" tabindex="-1"></a><span class="st">  node [shape=circle color=gray75]</span></span>
<span id="cb310-10"><a href="nn.html#cb310-10" aria-hidden="true" tabindex="-1"></a><span class="st">  l1_1, l1_2, l1_3, l2</span></span>
<span id="cb310-11"><a href="nn.html#cb310-11" aria-hidden="true" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb310-12"><a href="nn.html#cb310-12" aria-hidden="true" tabindex="-1"></a><span class="st">  edge [fontname=&#39;Roboto&#39; fontsize=10 fontcolor=gray50 color=&#39;#00aaff80&#39; arrowsize=.5];</span></span>
<span id="cb310-13"><a href="nn.html#cb310-13" aria-hidden="true" tabindex="-1"></a><span class="st">  X_1, X_2, X_3 -&gt;  l1_1, l1_2, l1_3</span></span>
<span id="cb310-14"><a href="nn.html#cb310-14" aria-hidden="true" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb310-15"><a href="nn.html#cb310-15" aria-hidden="true" tabindex="-1"></a><span class="st">   l1_1, l1_2, l1_3 -&gt; l2</span></span>
<span id="cb310-16"><a href="nn.html#cb310-16" aria-hidden="true" tabindex="-1"></a><span class="st">   </span></span>
<span id="cb310-17"><a href="nn.html#cb310-17" aria-hidden="true" tabindex="-1"></a><span class="st">   l2 -&gt; y</span></span>
<span id="cb310-18"><a href="nn.html#cb310-18" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb310-19"><a href="nn.html#cb310-19" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span></span>
<span id="cb310-20"><a href="nn.html#cb310-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb310-21"><a href="nn.html#cb310-21" aria-hidden="true" tabindex="-1"></a>DiagrammeR<span class="sc">::</span><span class="fu">grViz</span>(model)</span></code></pre></div>
<div id="htmlwidget-7a4c022717dc89ccfbbd" style="width:75%;height:504px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-7a4c022717dc89ccfbbd">{"x":{"diagram":"\ndigraph Factor  {\n  graph [rankdir=LR  bgcolor=transparent splines=\"line\"]\n  \n  node [fontname=\"Roboto\" fontsize=10 fontcolor=gray50 shape=box width=.5 color=\"#ff5500\"];\n  node [shape=square]\n  X_1, X_2, X_3, y\n  \n  node [shape=circle color=gray75]\n  l1_1, l1_2, l1_3, l2\n  \n  edge [fontname=\"Roboto\" fontsize=10 fontcolor=gray50 color=\"#00aaff80\" arrowsize=.5];\n  X_1, X_2, X_3 ->  l1_1, l1_2, l1_3\n  \n   l1_1, l1_2, l1_3 -> l2\n   \n   l2 -> y\n}\n","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
<div id="python-1" class="section level3">
<h3>Python</h3>
<p>For the following, I remove <code>layer_0</code>, as it is just the input matrix <code>X</code>.</p>
<div class="sourceCode" id="cb311"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb311-1"><a href="nn.html#cb311-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb311-2"><a href="nn.html#cb311-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-3"><a href="nn.html#cb311-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> nonlin(x, deriv <span class="op">=</span> <span class="va">False</span>):</span>
<span id="cb311-4"><a href="nn.html#cb311-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(deriv <span class="op">==</span> <span class="va">True</span>):</span>
<span id="cb311-5"><a href="nn.html#cb311-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> x<span class="op">*</span>(<span class="dv">1</span> <span class="op">-</span> x)</span>
<span id="cb311-6"><a href="nn.html#cb311-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span> <span class="op">+</span> np.exp(<span class="op">-</span>x))</span>
<span id="cb311-7"><a href="nn.html#cb311-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-8"><a href="nn.html#cb311-8" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> np.array([</span>
<span id="cb311-9"><a href="nn.html#cb311-9" aria-hidden="true" tabindex="-1"></a>  [<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>],</span>
<span id="cb311-10"><a href="nn.html#cb311-10" aria-hidden="true" tabindex="-1"></a>  [<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>],</span>
<span id="cb311-11"><a href="nn.html#cb311-11" aria-hidden="true" tabindex="-1"></a>  [<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>],</span>
<span id="cb311-12"><a href="nn.html#cb311-12" aria-hidden="true" tabindex="-1"></a>  [<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>]</span>
<span id="cb311-13"><a href="nn.html#cb311-13" aria-hidden="true" tabindex="-1"></a>])</span>
<span id="cb311-14"><a href="nn.html#cb311-14" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb311-15"><a href="nn.html#cb311-15" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.array([</span>
<span id="cb311-16"><a href="nn.html#cb311-16" aria-hidden="true" tabindex="-1"></a>  [<span class="dv">0</span>],</span>
<span id="cb311-17"><a href="nn.html#cb311-17" aria-hidden="true" tabindex="-1"></a>  [<span class="dv">1</span>],</span>
<span id="cb311-18"><a href="nn.html#cb311-18" aria-hidden="true" tabindex="-1"></a>  [<span class="dv">1</span>],</span>
<span id="cb311-19"><a href="nn.html#cb311-19" aria-hidden="true" tabindex="-1"></a>  [<span class="dv">0</span>]</span>
<span id="cb311-20"><a href="nn.html#cb311-20" aria-hidden="true" tabindex="-1"></a>])</span>
<span id="cb311-21"><a href="nn.html#cb311-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-22"><a href="nn.html#cb311-22" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">1</span>)</span>
<span id="cb311-23"><a href="nn.html#cb311-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-24"><a href="nn.html#cb311-24" aria-hidden="true" tabindex="-1"></a><span class="co"># randomly initialize our weights with mean 0</span></span>
<span id="cb311-25"><a href="nn.html#cb311-25" aria-hidden="true" tabindex="-1"></a>synapse_0 <span class="op">=</span> <span class="dv">2</span><span class="op">*</span>np.random.random((<span class="dv">3</span>, <span class="dv">4</span>)) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb311-26"><a href="nn.html#cb311-26" aria-hidden="true" tabindex="-1"></a>synapse_1 <span class="op">=</span> <span class="dv">2</span><span class="op">*</span>np.random.random((<span class="dv">4</span>, <span class="dv">1</span>)) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb311-27"><a href="nn.html#cb311-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-28"><a href="nn.html#cb311-28" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> np.arange(<span class="dv">60000</span>):</span>
<span id="cb311-29"><a href="nn.html#cb311-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-30"><a href="nn.html#cb311-30" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Feed forward through layers 0, 1, and 2</span></span>
<span id="cb311-31"><a href="nn.html#cb311-31" aria-hidden="true" tabindex="-1"></a>    layer_1 <span class="op">=</span> nonlin(np.dot(X, synapse_0))</span>
<span id="cb311-32"><a href="nn.html#cb311-32" aria-hidden="true" tabindex="-1"></a>    layer_2 <span class="op">=</span> nonlin(np.dot(layer_1, synapse_1))</span>
<span id="cb311-33"><a href="nn.html#cb311-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-34"><a href="nn.html#cb311-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># how much did we miss the target value?</span></span>
<span id="cb311-35"><a href="nn.html#cb311-35" aria-hidden="true" tabindex="-1"></a>    layer_2_error <span class="op">=</span> y <span class="op">-</span> layer_2</span>
<span id="cb311-36"><a href="nn.html#cb311-36" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb311-37"><a href="nn.html#cb311-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (j<span class="op">%</span> <span class="dv">10000</span>) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb311-38"><a href="nn.html#cb311-38" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;Error:&quot;</span> <span class="op">+</span> <span class="bu">str</span>(np.mean(np.<span class="bu">abs</span>(layer_2_error))))</span>
<span id="cb311-39"><a href="nn.html#cb311-39" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb311-40"><a href="nn.html#cb311-40" aria-hidden="true" tabindex="-1"></a>    <span class="co"># in what direction is the target value?</span></span>
<span id="cb311-41"><a href="nn.html#cb311-41" aria-hidden="true" tabindex="-1"></a>    <span class="co"># were we really sure? if so, don&#39;t change too much.</span></span>
<span id="cb311-42"><a href="nn.html#cb311-42" aria-hidden="true" tabindex="-1"></a>    layer_2_delta <span class="op">=</span> layer_2_error<span class="op">*</span>nonlin(layer_2,deriv<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb311-43"><a href="nn.html#cb311-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-44"><a href="nn.html#cb311-44" aria-hidden="true" tabindex="-1"></a>    <span class="co"># how much did each layer_1 value contribute to the layer_2 error (according to the weights)?</span></span>
<span id="cb311-45"><a href="nn.html#cb311-45" aria-hidden="true" tabindex="-1"></a>    layer_1_error <span class="op">=</span> layer_2_delta.dot(synapse_1.T)</span>
<span id="cb311-46"><a href="nn.html#cb311-46" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb311-47"><a href="nn.html#cb311-47" aria-hidden="true" tabindex="-1"></a>    <span class="co"># in what direction is the target layer_1?</span></span>
<span id="cb311-48"><a href="nn.html#cb311-48" aria-hidden="true" tabindex="-1"></a>    <span class="co"># were we really sure? if so, don&#39;t change too much.</span></span>
<span id="cb311-49"><a href="nn.html#cb311-49" aria-hidden="true" tabindex="-1"></a>    layer_1_delta <span class="op">=</span> layer_1_error <span class="op">*</span> nonlin(layer_1,deriv<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb311-50"><a href="nn.html#cb311-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-51"><a href="nn.html#cb311-51" aria-hidden="true" tabindex="-1"></a>    synapse_1 <span class="op">+=</span> layer_1.T.dot(layer_2_delta)</span>
<span id="cb311-52"><a href="nn.html#cb311-52" aria-hidden="true" tabindex="-1"></a>    synapse_0 <span class="op">+=</span> X.T.dot(layer_1_delta)</span></code></pre></div>
<pre><code>Error:0.4964100319027255
Error:0.008584525653247153
Error:0.005789459862507812
Error:0.004629176776769988
Error:0.003958765280273649
Error:0.003510122567861676</code></pre>
<div class="sourceCode" id="cb313"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb313-1"><a href="nn.html#cb313-1" aria-hidden="true" tabindex="-1"></a>np.<span class="bu">round</span>(layer_1, <span class="dv">3</span>)</span></code></pre></div>
<pre><code>array([[0.726, 0.116, 0.926, 0.997],
       [0.167, 0.   , 0.017, 0.897],
       [0.996, 0.895, 0.022, 0.838],
       [0.952, 0.025, 0.   , 0.115]])</code></pre>
<div class="sourceCode" id="cb315"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb315-1"><a href="nn.html#cb315-1" aria-hidden="true" tabindex="-1"></a>np.<span class="bu">round</span>(np.append(layer_2, y, axis <span class="op">=</span> <span class="dv">1</span>), <span class="dv">3</span>)</span></code></pre></div>
<pre><code>array([[0.003, 0.   ],
       [0.997, 1.   ],
       [0.997, 1.   ],
       [0.004, 0.   ]])</code></pre>
<div class="sourceCode" id="cb317"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb317-1"><a href="nn.html#cb317-1" aria-hidden="true" tabindex="-1"></a>np.<span class="bu">round</span>(synapse_0, <span class="dv">3</span>)</span></code></pre></div>
<pre><code>array([[ 4.601,  4.172, -6.31 , -4.197],
       [-2.584, -5.814, -6.608, -3.684],
       [ 0.975, -2.027,  2.529,  5.844]])</code></pre>
<div class="sourceCode" id="cb319"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb319-1"><a href="nn.html#cb319-1" aria-hidden="true" tabindex="-1"></a>np.<span class="bu">round</span>(synapse_1, <span class="dv">3</span>)</span></code></pre></div>
<pre><code>array([[ -6.968],
       [  7.141],
       [-10.319],
       [  7.861]])</code></pre>
</div>
<div id="r-1" class="section level3">
<h3>R</h3>
<p>In general different weights can ultimately produce similar predictions, and combinations for a particular node are arbitrary (e.g. node 1 in one network might become node 3 on a separate run), so things are somewhat more difficult to compare. However, what matters is the final prediction, and you should see basically the same result for R and Python.</p>
<div class="sourceCode" id="cb321"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb321-1"><a href="nn.html#cb321-1" aria-hidden="true" tabindex="-1"></a>X <span class="ot">=</span> <span class="fu">matrix</span>(</span>
<span id="cb321-2"><a href="nn.html#cb321-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>,</span>
<span id="cb321-3"><a href="nn.html#cb321-3" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>,</span>
<span id="cb321-4"><a href="nn.html#cb321-4" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>,</span>
<span id="cb321-5"><a href="nn.html#cb321-5" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb321-6"><a href="nn.html#cb321-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">nrow =</span> <span class="dv">4</span>,</span>
<span id="cb321-7"><a href="nn.html#cb321-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncol =</span> <span class="dv">3</span>,</span>
<span id="cb321-8"><a href="nn.html#cb321-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">byrow =</span> <span class="cn">TRUE</span></span>
<span id="cb321-9"><a href="nn.html#cb321-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb321-10"><a href="nn.html#cb321-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb321-11"><a href="nn.html#cb321-11" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">as.integer</span>(<span class="fu">xor</span>(X[,<span class="dv">1</span>], X[,<span class="dv">2</span>])), <span class="at">ncol =</span> <span class="dv">1</span>)  <span class="co"># make the relationship explicit</span></span>
<span id="cb321-12"><a href="nn.html#cb321-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb321-13"><a href="nn.html#cb321-13" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb321-14"><a href="nn.html#cb321-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb321-15"><a href="nn.html#cb321-15" aria-hidden="true" tabindex="-1"></a><span class="co"># create the same starting point to have results as similar as possible.</span></span>
<span id="cb321-16"><a href="nn.html#cb321-16" aria-hidden="true" tabindex="-1"></a><span class="co"># synapse_0 = py$syn0_init</span></span>
<span id="cb321-17"><a href="nn.html#cb321-17" aria-hidden="true" tabindex="-1"></a><span class="co"># synapse_1 = py$syn1_init</span></span>
<span id="cb321-18"><a href="nn.html#cb321-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb321-19"><a href="nn.html#cb321-19" aria-hidden="true" tabindex="-1"></a><span class="co"># or do randomly in same fashion</span></span>
<span id="cb321-20"><a href="nn.html#cb321-20" aria-hidden="true" tabindex="-1"></a>synapse_0 <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">runif</span>(<span class="dv">12</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="dv">3</span>, <span class="dv">4</span>)</span>
<span id="cb321-21"><a href="nn.html#cb321-21" aria-hidden="true" tabindex="-1"></a>synapse_1 <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">runif</span>(<span class="dv">12</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="dv">4</span>, <span class="dv">1</span>)</span>
<span id="cb321-22"><a href="nn.html#cb321-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb321-23"><a href="nn.html#cb321-23" aria-hidden="true" tabindex="-1"></a>synapse_0</span></code></pre></div>
<pre><code>           [,1]       [,2]      [,3]       [,4]
[1,] -0.4689827  0.8164156 0.8893505 -0.8764275
[2,] -0.2557522 -0.5966361 0.3215956 -0.5880509
[3,]  0.1457067  0.7967794 0.2582281 -0.6468865</code></pre>
<div class="sourceCode" id="cb323"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb323-1"><a href="nn.html#cb323-1" aria-hidden="true" tabindex="-1"></a>synapse_1</span></code></pre></div>
<pre><code>             [,1]
[1,]  0.374045693
[2,] -0.231792564
[3,]  0.539682840
[4,] -0.004601516</code></pre>
<div class="sourceCode" id="cb325"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb325-1"><a href="nn.html#cb325-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">60000</span>) {</span>
<span id="cb325-2"><a href="nn.html#cb325-2" aria-hidden="true" tabindex="-1"></a>  layer_1 <span class="ot">=</span> <span class="fu">plogis</span>(X  <span class="sc">%*%</span>  synapse_0)              <span class="co"># 4 x 4</span></span>
<span id="cb325-3"><a href="nn.html#cb325-3" aria-hidden="true" tabindex="-1"></a>  layer_2 <span class="ot">=</span> <span class="fu">plogis</span>(layer_1 <span class="sc">%*%</span>  synapse_1)         <span class="co"># 4 x 1</span></span>
<span id="cb325-4"><a href="nn.html#cb325-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb325-5"><a href="nn.html#cb325-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># how much did we miss the target value?</span></span>
<span id="cb325-6"><a href="nn.html#cb325-6" aria-hidden="true" tabindex="-1"></a>  layer_2_error <span class="ot">=</span> y <span class="sc">-</span> layer_2</span>
<span id="cb325-7"><a href="nn.html#cb325-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb325-8"><a href="nn.html#cb325-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> ((j <span class="sc">%%</span> <span class="dv">10000</span>) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb325-9"><a href="nn.html#cb325-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">message</span>(glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">&quot;Error: {mean(abs(layer_2_error))}&quot;</span>))</span>
<span id="cb325-10"><a href="nn.html#cb325-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb325-11"><a href="nn.html#cb325-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb325-12"><a href="nn.html#cb325-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># in what direction is the target value?</span></span>
<span id="cb325-13"><a href="nn.html#cb325-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># were we really sure? if so, don&#39;t change too much.</span></span>
<span id="cb325-14"><a href="nn.html#cb325-14" aria-hidden="true" tabindex="-1"></a>  layer_2_delta <span class="ot">=</span> (y <span class="sc">-</span> layer_2) <span class="sc">*</span> (layer_2 <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> layer_2))</span>
<span id="cb325-15"><a href="nn.html#cb325-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb325-16"><a href="nn.html#cb325-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># how much did each l1 value contribute to the l2 error (according to the weights)?</span></span>
<span id="cb325-17"><a href="nn.html#cb325-17" aria-hidden="true" tabindex="-1"></a>  l1_error <span class="ot">=</span> layer_2_delta <span class="sc">%*%</span> <span class="fu">t</span>(synapse_1)</span>
<span id="cb325-18"><a href="nn.html#cb325-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb325-19"><a href="nn.html#cb325-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># in what direction is the target l1?</span></span>
<span id="cb325-20"><a href="nn.html#cb325-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># were we really sure? if so, don&#39;t change too much.  </span></span>
<span id="cb325-21"><a href="nn.html#cb325-21" aria-hidden="true" tabindex="-1"></a>  layer_1_delta <span class="ot">=</span> <span class="fu">tcrossprod</span>(layer_2_delta, synapse_1) <span class="sc">*</span> (layer_1 <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> layer_1))</span>
<span id="cb325-22"><a href="nn.html#cb325-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb325-23"><a href="nn.html#cb325-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># update</span></span>
<span id="cb325-24"><a href="nn.html#cb325-24" aria-hidden="true" tabindex="-1"></a>  synapse_1 <span class="ot">=</span> synapse_1 <span class="sc">+</span> <span class="fu">crossprod</span>(layer_1, layer_2_delta)</span>
<span id="cb325-25"><a href="nn.html#cb325-25" aria-hidden="true" tabindex="-1"></a>  synapse_0 <span class="ot">=</span> synapse_0 <span class="sc">+</span> <span class="fu">crossprod</span>(X, layer_1_delta)</span>
<span id="cb325-26"><a href="nn.html#cb325-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb325-27"><a href="nn.html#cb325-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb325-28"><a href="nn.html#cb325-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb325-29"><a href="nn.html#cb325-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb325-30"><a href="nn.html#cb325-30" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(layer_1, <span class="dv">3</span>)</span></code></pre></div>
<pre><code>      [,1]  [,2]  [,3]  [,4]
[1,] 0.246 0.889 0.368 0.437
[2,] 0.000 0.032 0.980 0.027
[3,] 0.952 1.000 0.986 0.019
[4,] 0.014 0.985 1.000 0.001</code></pre>
<div class="sourceCode" id="cb327"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb327-1"><a href="nn.html#cb327-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">cbind</span>(layer_2, y), <span class="dv">3</span>)</span></code></pre></div>
<pre><code>      [,1] [,2]
[1,] 0.002    0
[2,] 0.995    1
[3,] 0.996    1
[4,] 0.006    0</code></pre>
<div class="sourceCode" id="cb329"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb329-1"><a href="nn.html#cb329-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(synapse_0, <span class="dv">3</span>)</span></code></pre></div>
<pre><code>       [,1]   [,2]   [,3]   [,4]
[1,]  4.100  7.593  4.768 -3.709
[2,] -7.198 -5.480  4.451 -3.321
[3,] -1.121  2.082 -0.543 -0.253</code></pre>
<div class="sourceCode" id="cb331"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb331-1"><a href="nn.html#cb331-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(synapse_1, <span class="dv">3</span>)</span></code></pre></div>
<pre><code>        [,1]
[1,]  11.656
[2,] -11.380
[3,]   5.884
[4,]  -2.998</code></pre>
</div>
</div>
<div id="example-3" class="section level2">
<h2>Example 3</h2>
<p>The next example follows the code from the second post listed above.</p>
<div class="sourceCode" id="cb333"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb333-1"><a href="nn.html#cb333-1" aria-hidden="true" tabindex="-1"></a><span class="co"># sigmoid function</span></span>
<span id="cb333-2"><a href="nn.html#cb333-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> nonlin(x, deriv <span class="op">=</span> <span class="va">False</span>):</span>
<span id="cb333-3"><a href="nn.html#cb333-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(deriv <span class="op">==</span> <span class="va">True</span>):</span>
<span id="cb333-4"><a href="nn.html#cb333-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> x <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> x)</span>
<span id="cb333-5"><a href="nn.html#cb333-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span> <span class="op">+</span> np.exp(<span class="op">-</span>x))</span>
<span id="cb333-6"><a href="nn.html#cb333-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb333-7"><a href="nn.html#cb333-7" aria-hidden="true" tabindex="-1"></a><span class="co"># input dataset</span></span>
<span id="cb333-8"><a href="nn.html#cb333-8" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> np.array([  [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>], </span>
<span id="cb333-9"><a href="nn.html#cb333-9" aria-hidden="true" tabindex="-1"></a>                [<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>], </span>
<span id="cb333-10"><a href="nn.html#cb333-10" aria-hidden="true" tabindex="-1"></a>                [<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>], </span>
<span id="cb333-11"><a href="nn.html#cb333-11" aria-hidden="true" tabindex="-1"></a>                [<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>] ])</span>
<span id="cb333-12"><a href="nn.html#cb333-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb333-13"><a href="nn.html#cb333-13" aria-hidden="true" tabindex="-1"></a><span class="co"># output dataset            </span></span>
<span id="cb333-14"><a href="nn.html#cb333-14" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.array([[<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>]]).T</span>
<span id="cb333-15"><a href="nn.html#cb333-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb333-16"><a href="nn.html#cb333-16" aria-hidden="true" tabindex="-1"></a><span class="co"># seed random numbers to make calculation</span></span>
<span id="cb333-17"><a href="nn.html#cb333-17" aria-hidden="true" tabindex="-1"></a><span class="co"># deterministic (just a good practice)</span></span>
<span id="cb333-18"><a href="nn.html#cb333-18" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">1</span>)</span>
<span id="cb333-19"><a href="nn.html#cb333-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb333-20"><a href="nn.html#cb333-20" aria-hidden="true" tabindex="-1"></a><span class="co"># initialize weights randomly with mean 0</span></span>
<span id="cb333-21"><a href="nn.html#cb333-21" aria-hidden="true" tabindex="-1"></a>syn0_init <span class="op">=</span> <span class="dv">2</span><span class="op">*</span>np.random.random((<span class="dv">3</span>, <span class="dv">1</span>)) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb333-22"><a href="nn.html#cb333-22" aria-hidden="true" tabindex="-1"></a>synapse_0 <span class="op">=</span> syn0_init</span>
<span id="cb333-23"><a href="nn.html#cb333-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb333-24"><a href="nn.html#cb333-24" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="bu">iter</span> <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10000</span>):</span>
<span id="cb333-25"><a href="nn.html#cb333-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb333-26"><a href="nn.html#cb333-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># forward propagation</span></span>
<span id="cb333-27"><a href="nn.html#cb333-27" aria-hidden="true" tabindex="-1"></a>    layer_0 <span class="op">=</span> X</span>
<span id="cb333-28"><a href="nn.html#cb333-28" aria-hidden="true" tabindex="-1"></a>    layer_1 <span class="op">=</span> nonlin(np.dot(layer_0, synapse_0))</span>
<span id="cb333-29"><a href="nn.html#cb333-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb333-30"><a href="nn.html#cb333-30" aria-hidden="true" tabindex="-1"></a>    <span class="co"># how much did we miss?</span></span>
<span id="cb333-31"><a href="nn.html#cb333-31" aria-hidden="true" tabindex="-1"></a>    l1_error <span class="op">=</span> y <span class="op">-</span> layer_1</span>
<span id="cb333-32"><a href="nn.html#cb333-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb333-33"><a href="nn.html#cb333-33" aria-hidden="true" tabindex="-1"></a>    <span class="co"># multiply how much we missed by the </span></span>
<span id="cb333-34"><a href="nn.html#cb333-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># slope of the sigmoid at the values in layer_1</span></span>
<span id="cb333-35"><a href="nn.html#cb333-35" aria-hidden="true" tabindex="-1"></a>    l1_delta <span class="op">=</span> l1_error <span class="op">*</span> nonlin(layer_1, <span class="va">True</span>)</span>
<span id="cb333-36"><a href="nn.html#cb333-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb333-37"><a href="nn.html#cb333-37" aria-hidden="true" tabindex="-1"></a>    <span class="co"># update weights</span></span>
<span id="cb333-38"><a href="nn.html#cb333-38" aria-hidden="true" tabindex="-1"></a>    synapse_0 <span class="op">+=</span> np.dot(layer_0.T, l1_delta)</span>
<span id="cb333-39"><a href="nn.html#cb333-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb333-40"><a href="nn.html#cb333-40" aria-hidden="true" tabindex="-1"></a><span class="co">&quot;Output After Training:&quot;</span></span>
<span id="cb333-41"><a href="nn.html#cb333-41" aria-hidden="true" tabindex="-1"></a>layer_1</span>
<span id="cb333-42"><a href="nn.html#cb333-42" aria-hidden="true" tabindex="-1"></a>l1_delta</span></code></pre></div>
<div class="sourceCode" id="cb334"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb334-1"><a href="nn.html#cb334-1" aria-hidden="true" tabindex="-1"></a><span class="co"># input dataset</span></span>
<span id="cb334-2"><a href="nn.html#cb334-2" aria-hidden="true" tabindex="-1"></a>X <span class="ot">=</span> <span class="fu">matrix</span>(</span>
<span id="cb334-3"><a href="nn.html#cb334-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>,</span>
<span id="cb334-4"><a href="nn.html#cb334-4" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>,</span>
<span id="cb334-5"><a href="nn.html#cb334-5" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>,</span>
<span id="cb334-6"><a href="nn.html#cb334-6" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb334-7"><a href="nn.html#cb334-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">nrow =</span> <span class="dv">4</span>,</span>
<span id="cb334-8"><a href="nn.html#cb334-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncol =</span> <span class="dv">3</span>,</span>
<span id="cb334-9"><a href="nn.html#cb334-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">byrow =</span> T</span>
<span id="cb334-10"><a href="nn.html#cb334-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb334-11"><a href="nn.html#cb334-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb334-12"><a href="nn.html#cb334-12" aria-hidden="true" tabindex="-1"></a><span class="co"># output dataset            </span></span>
<span id="cb334-13"><a href="nn.html#cb334-13" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>), <span class="at">ncol =</span> <span class="dv">1</span>)</span>
<span id="cb334-14"><a href="nn.html#cb334-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb334-15"><a href="nn.html#cb334-15" aria-hidden="true" tabindex="-1"></a>nonlin <span class="ot">=</span> <span class="cf">function</span>(x, <span class="at">deriv =</span> <span class="cn">FALSE</span>){</span>
<span id="cb334-16"><a href="nn.html#cb334-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(deriv <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb334-17"><a href="nn.html#cb334-17" aria-hidden="true" tabindex="-1"></a>    x <span class="sc">*</span> (<span class="dv">1</span><span class="sc">-</span>x)</span>
<span id="cb334-18"><a href="nn.html#cb334-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb334-19"><a href="nn.html#cb334-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plogis</span>(x)</span>
<span id="cb334-20"><a href="nn.html#cb334-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb334-21"><a href="nn.html#cb334-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb334-22"><a href="nn.html#cb334-22" aria-hidden="true" tabindex="-1"></a>synapse_0 <span class="ot">=</span> reticulate<span class="sc">::</span>py<span class="sc">$</span>syn0_init</span>
<span id="cb334-23"><a href="nn.html#cb334-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb334-24"><a href="nn.html#cb334-24" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10000</span>) {</span>
<span id="cb334-25"><a href="nn.html#cb334-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb334-26"><a href="nn.html#cb334-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># forward propagation</span></span>
<span id="cb334-27"><a href="nn.html#cb334-27" aria-hidden="true" tabindex="-1"></a>    layer_0 <span class="ot">=</span> X</span>
<span id="cb334-28"><a href="nn.html#cb334-28" aria-hidden="true" tabindex="-1"></a>    layer_1 <span class="ot">=</span> <span class="fu">nonlin</span>(layer_0 <span class="sc">%*%</span>  synapse_0)</span>
<span id="cb334-29"><a href="nn.html#cb334-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb334-30"><a href="nn.html#cb334-30" aria-hidden="true" tabindex="-1"></a>    <span class="co"># how much did we miss?</span></span>
<span id="cb334-31"><a href="nn.html#cb334-31" aria-hidden="true" tabindex="-1"></a>    l1_error <span class="ot">=</span> y <span class="sc">-</span> layer_1</span>
<span id="cb334-32"><a href="nn.html#cb334-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb334-33"><a href="nn.html#cb334-33" aria-hidden="true" tabindex="-1"></a>    <span class="co"># multiply how much we missed by the </span></span>
<span id="cb334-34"><a href="nn.html#cb334-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># slope of the sigmoid at the values in layer_1</span></span>
<span id="cb334-35"><a href="nn.html#cb334-35" aria-hidden="true" tabindex="-1"></a>    l1_delta <span class="ot">=</span> l1_error <span class="sc">*</span> <span class="fu">nonlin</span>(layer_1, <span class="cn">TRUE</span>)</span>
<span id="cb334-36"><a href="nn.html#cb334-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb334-37"><a href="nn.html#cb334-37" aria-hidden="true" tabindex="-1"></a>    <span class="co"># update weights</span></span>
<span id="cb334-38"><a href="nn.html#cb334-38" aria-hidden="true" tabindex="-1"></a>    synapse_0 <span class="ot">=</span> synapse_0 <span class="sc">+</span> <span class="fu">crossprod</span>(layer_0, l1_delta)</span>
<span id="cb334-39"><a href="nn.html#cb334-39" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb334-40"><a href="nn.html#cb334-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb334-41"><a href="nn.html#cb334-41" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="st">&quot;Output After Training:</span><span class="sc">\n</span><span class="st">n&quot;</span>)</span>
<span id="cb334-42"><a href="nn.html#cb334-42" aria-hidden="true" tabindex="-1"></a>layer_1</span>
<span id="cb334-43"><a href="nn.html#cb334-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb334-44"><a href="nn.html#cb334-44" aria-hidden="true" tabindex="-1"></a>l1_delta</span></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="gaussian-process.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="elm.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["twitter", "facebook", "linkedin", "google", "weibo", "instapaper"],
"google": false,
"instapper": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/m-clark/models-by-example/blob/master/nn.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section",
"depth": 2,
"scroll_highlight": true
},
"df_print": "kable",
"highlight": "pygments",
"search": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
